from collections import deque
n, m = map(int,input().split())

distance = [[0 for _ in range(m)] for _ in range(n)]
graph = [[0 for _ in range(m)] for _ in range(n)]
dr = [-1,1,0,0]     #r,c 주변 체크를 위해 배열
dc = [0,0,1,-1]


for i in range(n):
    li = input().rstrip() #띄어쓰기 없으니까 split, int 쓰지 않고 문자열로 받는다
    for j in range(m):
        graph[i][j] = int(li[j])    #graph에 입력받은 값 입력

def printf():
    for i in range(n):
        for j in range(m):
            print(distance[i][j], end = ' ')
        print()
    print()

def DFS(r,c,depth):
    for i in range(4):  #위에서 선언한 dr,dc가 4자리 배열이다
            nr = r + dr[i]  #다음 r은 현재+다음배열
            nc = c + dc[i]  #다음 c는 현재+다음배열
            if nr>=0 and nr<n and nc>=0 and nc<m:   #0<=nr, nc<=n,m
                if graph[nr][nc] == 1 and (distance[nr][nc] ==0 or distance[nr][nc]>depth+1):
                    print('현재 위치 = (%d, %d),   다음에 갈 위치 = (%d, %d)' %(r,c,nr,nc))
                    printf()
                    distance[nr][nc] = depth+1 #distance배열의  현재 값에 1씩 더한다.
                    printf()
                    DFS(nr,nc, depth+1)
    
def BFS():
    q = deque()     #queue선언
    q.append([0,0])     #queue첫번째 값 입력
    while len(q) != 0:      #DFS 1차 반복문
        now = q.popleft()   #큐에 입력된 순서대로 now에 입력[a,b]값으로
        r = now[0]  #now[0,1]중 0
        c = now[1]  #now[0,1]중 1
        for i in range(4):  #위에서 선언한 dr,dc가 4자리 배열이다
            nr = r + dr[i]  #다음 r은 현재+다음배열
            nc = c + dc[i]  #다음 c는 현재+다음배열
            if nr>=0 and nr<n and nc>=0 and nc<m:   #0<=nr, nc<=n,m
                if graph[nr][nc] == 1 and distance[nr][nc] == 0:
                    distance[nr][nc] = distance[r][c]+1 #distance배열의  현재 값에 1씩 더한다.
                    q.append([nr,nc])   #증가값 queue에 입력

#distance[0][0] = 1 #distance의 첫번째 값을 1로 줘서 BFS에서 if문 돌아가
#BFS()
distance[0][0] = 1
DFS(0,0,1)
                    
for i in range(n):
    for j in range(m):        
        print(distance[i][j],end=' ')
    print()
print(distance[n-1][m-1])   #distance마지막 값


#########################################
4 6
110110
110110
111111
111101
현재 위치 = (0, 0),   다음에 갈 위치 = (1, 0)
1 0 0 0 0 0 
0 0 0 0 0 0 
0 0 0 0 0 0 
0 0 0 0 0 0 

1 0 0 0 0 0 
2 0 0 0 0 0 
0 0 0 0 0 0 
0 0 0 0 0 0 

현재 위치 = (1, 0),   다음에 갈 위치 = (2, 0)
1 0 0 0 0 0 
2 0 0 0 0 0 
0 0 0 0 0 0 
0 0 0 0 0 0 

1 0 0 0 0 0 
2 0 0 0 0 0 
3 0 0 0 0 0 
0 0 0 0 0 0 

현재 위치 = (2, 0),   다음에 갈 위치 = (3, 0)
1 0 0 0 0 0 
2 0 0 0 0 0 
3 0 0 0 0 0 
0 0 0 0 0 0 

1 0 0 0 0 0 
2 0 0 0 0 0 
3 0 0 0 0 0 
4 0 0 0 0 0 

현재 위치 = (3, 0),   다음에 갈 위치 = (3, 1)
1 0 0 0 0 0 
2 0 0 0 0 0 
3 0 0 0 0 0 
4 0 0 0 0 0 

1 0 0 0 0 0 
2 0 0 0 0 0 
3 0 0 0 0 0 
4 5 0 0 0 0 

현재 위치 = (3, 1),   다음에 갈 위치 = (2, 1)
1 0 0 0 0 0 
2 0 0 0 0 0 
3 0 0 0 0 0 
4 5 0 0 0 0 

1 0 0 0 0 0 
2 0 0 0 0 0 
3 6 0 0 0 0 
4 5 0 0 0 0 

현재 위치 = (2, 1),   다음에 갈 위치 = (1, 1)
1 0 0 0 0 0 
2 0 0 0 0 0 
3 6 0 0 0 0 
4 5 0 0 0 0 

1 0 0 0 0 0 
2 7 0 0 0 0 
3 6 0 0 0 0 
4 5 0 0 0 0 

현재 위치 = (1, 1),   다음에 갈 위치 = (0, 1)
1 0 0 0 0 0 
2 7 0 0 0 0 
3 6 0 0 0 0 
4 5 0 0 0 0 

1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 0 0 0 0 
4 5 0 0 0 0 

현재 위치 = (2, 1),   다음에 갈 위치 = (2, 2)
1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 0 0 0 0 
4 5 0 0 0 0 

1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 7 0 0 0 
4 5 0 0 0 0 

현재 위치 = (2, 2),   다음에 갈 위치 = (3, 2)
1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 7 0 0 0 
4 5 0 0 0 0 

1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 7 0 0 0 
4 5 8 0 0 0 

현재 위치 = (3, 2),   다음에 갈 위치 = (3, 3)
1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 7 0 0 0 
4 5 8 0 0 0 

1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 7 0 0 0 
4 5 8 9 0 0 

현재 위치 = (3, 3),   다음에 갈 위치 = (2, 3)
1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 7 0 0 0 
4 5 8 9 0 0 

1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

현재 위치 = (2, 3),   다음에 갈 위치 = (1, 3)
1 8 0 0 0 0 
2 7 0 0 0 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

1 8 0 0 0 0 
2 7 0 11 0 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

현재 위치 = (1, 3),   다음에 갈 위치 = (0, 3)
1 8 0 0 0 0 
2 7 0 11 0 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

1 8 0 12 0 0 
2 7 0 11 0 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

현재 위치 = (0, 3),   다음에 갈 위치 = (0, 4)
1 8 0 12 0 0 
2 7 0 11 0 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

1 8 0 12 13 0 
2 7 0 11 0 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

현재 위치 = (0, 4),   다음에 갈 위치 = (1, 4)
1 8 0 12 13 0 
2 7 0 11 0 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

1 8 0 12 13 0 
2 7 0 11 14 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

현재 위치 = (1, 4),   다음에 갈 위치 = (2, 4)
1 8 0 12 13 0 
2 7 0 11 14 0 
3 6 7 10 0 0 
4 5 8 9 0 0 

1 8 0 12 13 0 
2 7 0 11 14 0 
3 6 7 10 15 0 
4 5 8 9 0 0 

현재 위치 = (2, 4),   다음에 갈 위치 = (2, 5)
1 8 0 12 13 0 
2 7 0 11 14 0 
3 6 7 10 15 0 
4 5 8 9 0 0 

1 8 0 12 13 0 
2 7 0 11 14 0 
3 6 7 10 15 16 
4 5 8 9 0 0 

현재 위치 = (2, 5),   다음에 갈 위치 = (3, 5)
1 8 0 12 13 0 
2 7 0 11 14 0 
3 6 7 10 15 16 
4 5 8 9 0 0 

1 8 0 12 13 0 
2 7 0 11 14 0 
3 6 7 10 15 16 
4 5 8 9 0 17 

현재 위치 = (1, 3),   다음에 갈 위치 = (1, 4)
1 8 0 12 13 0 
2 7 0 11 14 0 
3 6 7 10 15 16 
4 5 8 9 0 17 

1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 15 16 
4 5 8 9 0 17 

현재 위치 = (1, 4),   다음에 갈 위치 = (2, 4)
1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 15 16 
4 5 8 9 0 17 

1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 13 16 
4 5 8 9 0 17 

현재 위치 = (2, 4),   다음에 갈 위치 = (2, 5)
1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 13 16 
4 5 8 9 0 17 

1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 13 14 
4 5 8 9 0 17 

현재 위치 = (2, 5),   다음에 갈 위치 = (3, 5)
1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 13 14 
4 5 8 9 0 17 

1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 13 14 
4 5 8 9 0 15 

현재 위치 = (2, 3),   다음에 갈 위치 = (2, 4)
1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 13 14 
4 5 8 9 0 15 

1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 11 14 
4 5 8 9 0 15 

현재 위치 = (2, 4),   다음에 갈 위치 = (2, 5)
1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 11 14 
4 5 8 9 0 15 

1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 11 12 
4 5 8 9 0 15 

현재 위치 = (2, 5),   다음에 갈 위치 = (3, 5)
1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 11 12 
4 5 8 9 0 15 

1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 11 12 
4 5 8 9 0 13 

현재 위치 = (2, 2),   다음에 갈 위치 = (2, 3)
1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 10 11 12 
4 5 8 9 0 13 

1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

현재 위치 = (2, 3),   다음에 갈 위치 = (1, 3)
1 8 0 12 13 0 
2 7 0 11 12 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

1 8 0 12 13 0 
2 7 0 9 12 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

현재 위치 = (1, 3),   다음에 갈 위치 = (0, 3)
1 8 0 12 13 0 
2 7 0 9 12 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

1 8 0 10 13 0 
2 7 0 9 12 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

현재 위치 = (0, 3),   다음에 갈 위치 = (0, 4)
1 8 0 10 13 0 
2 7 0 9 12 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

1 8 0 10 11 0 
2 7 0 9 12 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

현재 위치 = (1, 3),   다음에 갈 위치 = (1, 4)
1 8 0 10 11 0 
2 7 0 9 12 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

현재 위치 = (2, 3),   다음에 갈 위치 = (2, 4)
1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 11 12 
4 5 8 9 0 13 

1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 12 
4 5 8 9 0 13 

현재 위치 = (2, 4),   다음에 갈 위치 = (2, 5)
1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 12 
4 5 8 9 0 13 

1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 10 
4 5 8 9 0 13 

현재 위치 = (2, 5),   다음에 갈 위치 = (3, 5)
1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 10 
4 5 8 9 0 13 

1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 10 
4 5 8 9 0 11 

현재 위치 = (3, 1),   다음에 갈 위치 = (3, 2)
1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 10 
4 5 8 9 0 11 

1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 10 
4 5 6 9 0 11 

현재 위치 = (3, 2),   다음에 갈 위치 = (3, 3)
1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 10 
4 5 6 9 0 11 

1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 10 
4 5 6 7 0 11 

현재 위치 = (2, 0),   다음에 갈 위치 = (2, 1)
1 8 0 10 11 0 
2 7 0 9 10 0 
3 6 7 8 9 10 
4 5 6 7 0 11 

1 8 0 10 11 0 
2 7 0 9 10 0 
3 4 7 8 9 10 
4 5 6 7 0 11 

현재 위치 = (2, 1),   다음에 갈 위치 = (1, 1)
1 8 0 10 11 0 
2 7 0 9 10 0 
3 4 7 8 9 10 
4 5 6 7 0 11 

1 8 0 10 11 0 
2 5 0 9 10 0 
3 4 7 8 9 10 
4 5 6 7 0 11 

현재 위치 = (1, 1),   다음에 갈 위치 = (0, 1)
1 8 0 10 11 0 
2 5 0 9 10 0 
3 4 7 8 9 10 
4 5 6 7 0 11 

1 6 0 10 11 0 
2 5 0 9 10 0 
3 4 7 8 9 10 
4 5 6 7 0 11 

현재 위치 = (2, 1),   다음에 갈 위치 = (2, 2)
1 6 0 10 11 0 
2 5 0 9 10 0 
3 4 7 8 9 10 
4 5 6 7 0 11 

1 6 0 10 11 0 
2 5 0 9 10 0 
3 4 5 8 9 10 
4 5 6 7 0 11 

현재 위치 = (2, 2),   다음에 갈 위치 = (2, 3)
1 6 0 10 11 0 
2 5 0 9 10 0 
3 4 5 8 9 10 
4 5 6 7 0 11 

1 6 0 10 11 0 
2 5 0 9 10 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

현재 위치 = (2, 3),   다음에 갈 위치 = (1, 3)
1 6 0 10 11 0 
2 5 0 9 10 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

1 6 0 10 11 0 
2 5 0 7 10 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

현재 위치 = (1, 3),   다음에 갈 위치 = (0, 3)
1 6 0 10 11 0 
2 5 0 7 10 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

1 6 0 8 11 0 
2 5 0 7 10 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

현재 위치 = (0, 3),   다음에 갈 위치 = (0, 4)
1 6 0 8 11 0 
2 5 0 7 10 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

1 6 0 8 9 0 
2 5 0 7 10 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

현재 위치 = (1, 3),   다음에 갈 위치 = (1, 4)
1 6 0 8 9 0 
2 5 0 7 10 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

1 6 0 8 9 0 
2 5 0 7 8 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

현재 위치 = (2, 3),   다음에 갈 위치 = (2, 4)
1 6 0 8 9 0 
2 5 0 7 8 0 
3 4 5 6 9 10 
4 5 6 7 0 11 

1 6 0 8 9 0 
2 5 0 7 8 0 
3 4 5 6 7 10 
4 5 6 7 0 11 

현재 위치 = (2, 4),   다음에 갈 위치 = (2, 5)
1 6 0 8 9 0 
2 5 0 7 8 0 
3 4 5 6 7 10 
4 5 6 7 0 11 

1 6 0 8 9 0 
2 5 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 11 

현재 위치 = (2, 5),   다음에 갈 위치 = (3, 5)
1 6 0 8 9 0 
2 5 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 11 

1 6 0 8 9 0 
2 5 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 9 

현재 위치 = (1, 0),   다음에 갈 위치 = (1, 1)
1 6 0 8 9 0 
2 5 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 9 

1 6 0 8 9 0 
2 3 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 9 

현재 위치 = (1, 1),   다음에 갈 위치 = (0, 1)
1 6 0 8 9 0 
2 3 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 9 

1 4 0 8 9 0 
2 3 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 9 

현재 위치 = (0, 0),   다음에 갈 위치 = (0, 1)
1 4 0 8 9 0 
2 3 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 9 

1 2 0 8 9 0 
2 3 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 9 

1 2 0 8 9 0 
2 3 0 7 8 0 
3 4 5 6 7 8 
4 5 6 7 0 9 